# Lefthook configuration for Playwright Coverage Reporter
# https://lefthook.dev/configuration/

pre-commit:
  commands:
    # Lint before committing
    lint:
      run: npm run lint

    # Validate ESM configuration before committing
    validate-esm:
      run: npm run validate:esm

    # Build before committing
    build:
      run: npm run build

    # Validate bundle before committing (ensures Playwright compatibility)
    validate-bundle:
      run: npm run test:bundle

    # Bump version on commits that change source files (but skip version bump commits)
    version-bump:
      run: npx -y package-bump@latest patch --stage

pre-push:
  commands:
    # Comprehensive test suite before pushing
    # This ensures all unit, integration, and critical e2e tests pass
    test:
      run: npm run test:all
      glob: "{src,tests}/**/*.{ts,js,json}"
